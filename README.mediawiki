{{ZenPack
|Summary=This ZenPack provides status and performance monitoring of Hadoop cluster.
|Organization=Zenoss, Inc.
|ZenPack name=ZenPacks.zenoss.Hadoop
|Source URI=
|Releases={{Release
|Version=
|Tag=
|Release date=
|Compatible with=Zenoss Core 4.2.x, Zenoss Resource Manager 4.1.x, Zenoss Resource Manager 4.2.x
|Requires=PythonCollector
}}
|Devices=
|Applications={{Application
|Product Name=Hadoop
}}
|Integrations=
|DataAudits=
|Binaries=
|Flavor=commercial
}}

The <span class="zenpack">ZenPacks.zenoss.Hadoop</span> ZenPack monitors Hadoop clusters 
via JMX web interface (''JMXJsonServlet'') with secure access over SSH.

__TOC__

== Gallery ==
<gallery widths=250px heights=127px>
</gallery>
== Features ==
The features added by this ZenPack can be summarized as follows.
They are each detailed further below.
* Discovery and periodic remodeling of relevant components.
* Performance monitoring.
* Event monitoring.
* Optional service impact with addition of Zenoss Service Dynamics product.
=== Discovery ===
The following values are discovered through zProperties you provide:
; Hadoop Data Node
: ''Attributes'': Name, Last Contacted, Health State
; Hadoop Job Tracker
: ''Attributes'': Name, Last Contacted, Health State
; Hadoop Secondery Name Node
: ''Attributes'': Name, Last Contacted, Health State
=== Performance Monitoring ===
The following metrics will be collected and graphed every 5 minutes by default:
; Device (Hadoop Name Node)
: ''Heap/Non Heap Memory'': Heap Memory Capacity Bytes, Heap Memory Used Bytes, Non Heap Memory Capacity Bytes, Non Heap Memory Used Bytes
: ''Nodes'': Dead Nodes Count, Live Nodes Count
: ''Performance metrics'': Threads, Total Files
; Hadoop Data Node
: ''Blocks'': Blocks Written, Blocks Read, Blocks Removed
: ''Heap/Non Heap Memory'': Heap Memory Capacity Bytes, Heap Memory Used Bytes, Non Heap Memory Capacity Bytes, Non Heap Memory Used Bytes
: ''Tasks'': Tasks Completed, Tasks Failed Timeout, Tasks Failed Ping
: ''Performance metrics'': Reduces Running, Maps Running
; Hadoop Job Tracker
: ''Heap/Non Heap Memory'': Heap Memory Capacity Bytes, Heap Memory Used Bytes, Non Heap Memory Capacity Bytes, Non Heap Memory Used Bytes
: ''Jobs'': Jobs Running, Jobs Failed, Jobs Completed
: ''Performance metrics'': Reduces Running, Maps Running
; Hadoop Secondery Name Node
: ''Heap/Non Heap Memory'': Heap Memory Capacity Bytes, Heap Memory Used Bytes, Non Heap Memory Capacity Bytes, Non Heap Memory Used Bytes
=== Event monitoring ===
The following events will be triggered with respect to the monitored metrics:
; Device (Hadoop Name Node)
: ''Error'': No data received.
; Hadoop Data Node
: ''Error'': The node is down.
; Hadoop Job Tracker
: ''Error'': The job tracker is down.
; Hadoop Secondery Name Node
: ''Error'': The node is down.
=== Service Impact ===
When combined with the Zenoss Service Dynamics product, this ZenPack adds
built-in service impact capability for Hadoop. The following service impact
relationships are automatically added. These will be included in any services
containing one or more of the explicitly mentioned entities.
;Service Impact Relationships
* Data Node, Secondery Name Node or Job Tracker failure affects related device.
== Usage ==
Use the following steps to start monitoring Hadoop cluster:
# Select ''Infrastructure'' from the navigation bar.
# Click the device name in the device list. The device overview page appears.
# Select ''Configuration Properties'' from the left panel.
# Set the ''zCommandUsername'' and ''zCommandPassword''  to setup SSH access.
# Navigate to the ''Modeler plugins'' page of the device containing your Hadoop server, add the ''zenoss.cmd.HadoopDataNode'' and ''zenoss.cmd.HadoopServiceNode'' modeler plugins.
# Select ''Bind Templates'' from the Action menu. The ''Bind Templates'' dialog appears.
# Add the ''Hadoop'' template to the list of selected templates, and then click ''Submit''.

{{note}} The ''zCommandUsername'' property must be set. To use public key authentication you 
must verify that the public portion of the key referenced in ''zKeyPath'' is installed in 
the <code>~/.ssh/authorized_keys</code> file for the appropriate user on the Hadoop server machine. 
If this key has a passphrase you should set it in the ''zCommandPassword'' property. 
If you'd rather use password authentication than setup keys, simply put the user's 
password in the ''zCommandPassword'' property.
----


Alternatively you can use zenbatchload to add Hadoop monitoring servers from the command line.
To do this, you must create a text file with hostname, username and password of all the
servers you want to add. The devices shuld be added under the the tagget machine device class
(e.g. '/Devices/Server/Linux' in the example below).
<syntaxhighlight lang="text">
/Devices/Server/Linux zCollectorPlugins=['zenoss.cmd.HadoopDataNode', 'zenoss.cmd.HadoopServiceNode'], zDeviceTemplates=['Hadoop']
<HOST NAME> zCommandUsername='<USERNAME>', zCommandPassword='<PASSWORD>'
</syntaxhighlight>
You can then load the Hadoop monitoring servers into Zenoss Core or Resource Manager as devices with the following command.
<console>
$ ##i##zenbatchload <filename>
</console>
== Prerequisites ==
This ZenPack uses the default web UI ports for Hadoop performance monitoring,
therefore please make sure that they were not changed in the ''conf/core-site.xml'' 
and the UI instance is running.

The default ports used for Hadoop monitoring are as follows:
{| class="wikitable"
!width="50%"|Daemon
!width="50%"|Port
|-
|Namenode 
|50070
|-
|Datanodes 
|50075
|-
|Secondarynamenode 
|50090
|-
|Jobracker 
|50030
|-
|Tasktrackers
|50060
|}
== Troubleshooting ==
Please refer the the Zenoss Service Dynamics documentation if you run into
any of the following problems:
* ZenPack will not install
* Adding a device fails
* Don't understand how to add a device
* Don't understand how to model a device
If you cannot find the answer in the documentation, then Resource Manager (Service Dynamics)
users should contact [https://support.zenoss.com Zenoss Customer Support].
Core users can use the #zenoss IRC channel or the community.zenoss.org forums.
== Installed Items ==
Installing this ZenPack will add the following items to your Zenoss system.
;Modeler Plugins
* zenoss.cmd.HadoopDataNode
* zenoss.cmd.HadoopServiceNode
;Monitoring Templates
* Hadoop (in /Server)
* HadoopDataNode (in /Server)
* HadoopJobTracker (in /Server)
* HadoopSecondaryNameNode (in /Server)
;Component Types
* HadoopDataNode (on related device)
* HadoopJobTracker (on related device)
* HadoopSecondaryNameNode (on related device)
== Daemons ==
{| class="wikitable"
!width="50%"|Type
!width="50%"|Name
|-
|Performance Collector
|zencommand
|}

{{ZenPackFooter}}
